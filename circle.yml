machine:
  environment:
    PROJECT_WORKSPACE: "${HOME}/.go_project" 
    LIB_WORKSPACE: "${HOME}/.go_workspace"
    GOPATH: "${LIB_WORKSPACE}:${PROJECT_WORKSPACE}"

dependencies:
  pre:
    - install --directory "${PROJECT_WORKSPACE}/src/github.com/herrschwarz"
    - ln -s ~/compose-validate "${PROJECT_WORKSPACE}/src/github.com/herrschwarz/compose-validate"
    - cd ${PROJECT_WORKSPACE}/src/github.com/herrschwarz/compose-validate
  override:
    - go get -t -d -v ./...
    - go install -v

test:
  override:
    - go test
  post:
    - install ${PROJECT_WORKSPACE}/bin/compose-validate $CIRCLE_ARTIFACTS


