machine:
  environment:
    PROJECT_WORKSPACE: "${HOME}/.go_project" 
    LIB_WORKSPACE: "${HOME}/.go_workspace"
    GOPATH: "${LIB_WORKSPACE}:${PROJECT_WORKSPACE}"
    REPO: compose-validate
    USER_PATH: github.com/herrschwarz
    PACKAGE: USER_PATH/${REPO}

dependencies:
  pre:
    - install --directory "${PROJECT_WORKSPACE}/src/${USER_PATH}"
    - ln -s ~/compose-validate "${PROJECT_WORKSPACE}/src/${PACKAGE}"
  override:
    - go get -t -d -v ${PACKAGE}
    - go install -v ${PACKAGE}

test:
  override:
    - go test
  post:
    - install ${PROJECT_WORKSPACE}/bin/compose-validate $CIRCLE_ARTIFACTS


